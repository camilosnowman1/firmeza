@{
    ViewData["Title"] = "Import Data";
}

<h2>Import Data from Excel</h2>
<hr />

@if (TempData["ErrorMessage"] != null)
{
    <div class="alert alert-danger">@TempData["ErrorMessage"]</div>
}

<div class="row">
    <!-- Product Import Card -->
    <div class="col-md-4 mb-4">
        <div class="card h-100">
            <div class="card-header">
                <h4>Import Products</h4>
            </div>
            <div class="card-body">
                <p>File must contain 'Product Name' and 'Price' columns.</p>
                <form asp-action="UploadProducts" method="post" enctype="multipart/form-data">
                    <div class="form-group">
                        <input type="file" name="file" class="form-control" required />
                    </div>
                    <button type="submit" class="btn btn-primary mt-2">Upload Products</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Customer Import Card -->
    <div class="col-md-4 mb-4">
        <div class="card h-100">
            <div class="card-header">
                <h4>Import Customers</h4>
            </div>
            <div class="card-body">
                <p>File must contain 'FullName', 'Document', and 'Email' columns.</p>
                <form asp-action="UploadCustomers" method="post" enctype="multipart/form-data">
                    <div class="form-group">
                        <input type="file" name="file" class="form-control" required />
                    </div>
                    <button type="submit" class="btn btn-info mt-2">Upload Customers</button>
                </form>
            </div>
        </div>
    </div>
    
    <!-- Vehicle Import Card -->
    <div class="col-md-4 mb-4">
        <div class="card h-100">
            <div class="card-header">
                <h4>Import Vehicles</h4>
            </div>
            <div class="card-body">
                <p>File must contain 'Name', 'Description', and 'HourlyRate' columns.</p>
                <form asp-action="UploadVehicles" method="post" enctype="multipart/form-data">
                    <div class="form-group">
                        <input type="file" name="file" class="form-control" required />
                    </div>
                    <button type="submit" class="btn btn-warning mt-2">Upload Vehicles</button>
                </form>
            </div>
        </div>
    </div>
</div>

@if (TempData["ImportLog"] != null)
{
    <div class="mt-4">
        <h3>Import Result</h3>
        <pre class="alert alert-secondary">@TempData["ImportLog"]</pre>
    </div>
}
